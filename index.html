<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Google</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
  <h2>üîê ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Google</h2>

  <div id="login-section">
    <a href="https://accounts.google.com/o/oauth2/v2/auth?client_id=977953618500-objng5gqbtf9iiko1d6drm6okhk4ma0p.apps.googleusercontent.com&redirect_uri=https://script.google.com/macros/d/1n53LS09KYNwnNxsqNrF0bosL8-JCWxXgLlAJbZbaLA6MaYUuNQ7YRJan/usercallback&response_type=token&scope=profile%20email">
      ‚ûú Login with Google
    </a>
  </div>

  <div id="checkin-section" style="display:none;">
    <h2>‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢ GPS</h2>
    <form id="checkinForm">
      <input type="hidden" name="name" id="nameInput">
      <input type="hidden" name="status" value="‡∏°‡∏≤‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏ö">
      <button type="submit">‚úÖ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</button>
    </form>
    <div id="result" style="margin-top: 20px; font-weight: bold;"></div>
  </div>

  <script>
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxjI2W_yjCCVgux4Tp_kwXDYAA1EUl7izze-FcXgv0v9m87L74OQ-NN6GyBxFoEFoZ6Nw/exec";

    // ‡∏î‡∏∂‡∏á access token ‡∏à‡∏≤‡∏Å URL (‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å redirect)
    const urlParams = new URLSearchParams(window.location.hash.substr(1));
    const accessToken = urlParams.get("access_token");

    if (accessToken) {
      // ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏° Login
      document.getElementById("login-section").style.display = "none";

      // ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏à‡∏≤‡∏Å Google
      fetch("https://www.googleapis.com/oauth2/v3

